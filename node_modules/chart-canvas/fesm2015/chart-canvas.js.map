{"version":3,"file":"chart-canvas.js","sources":["../../src/app/modules/chart/util.chart.ts","../../src/app/modules/chart/chart-dunot.component.ts","../../src/app/modules/chart/chart-pie.component.ts","../../src/app/modules/chart/chart.module.ts","../../chart-canvas.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class UtilChart {\r\n  drawPieSlice(ctx, centerX, centerY, radius, startAngle, endAngle, color) {\r\n    ctx.fillStyle = color;\r\n    ctx.beginPath();\r\n    ctx.moveTo(centerX, centerY);\r\n    ctx.arc(centerX, centerY, radius, startAngle, endAngle);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n  }\r\n}\r\n","import { Component, AfterViewInit, ElementRef, ViewChild, Input } from '@angular/core';\r\nimport { UtilChart } from './util.chart';\r\n\r\n@Component({\r\n  selector: 'canvas-chart-dunot',\r\n  template: `\r\n           <div style='display: flex;flex-wrap: nowrap;'>\r\n                <canvas #canvas></canvas>\r\n                <div #legend></div>\r\n           </div>\r\n    `\r\n})\r\nexport class ChartDunotComponent extends UtilChart implements AfterViewInit {\r\n  @ViewChild('canvas')\r\n  public canvas: ElementRef;\r\n  @ViewChild('legend')\r\n  public legend: ElementRef;\r\n\r\n  @Input()\r\n  data: any = {};\r\n  @Input()\r\n  colors: string[] = [];\r\n  private doughnutHoleSize: number = 0.5;\r\n\r\n  ngAfterViewInit(): void {\r\n    let canvasEl: HTMLCanvasElement = this.canvas.nativeElement;\r\n    let ctx = canvasEl.getContext('2d');\r\n\r\n    let total_value = 0;\r\n    let color_index = 0;\r\n    for (var categ in this.data) {\r\n      var val = this.data[categ];\r\n      total_value += val;\r\n    }\r\n\r\n    let start_angle = 0;\r\n    for (categ in this.data) {\r\n      val = this.data[categ];\r\n      var slice_angle = (2 * Math.PI * val) / total_value;\r\n\r\n      let widthCanvas = canvasEl.width / 2;\r\n      let heightCanvas = canvasEl.height / 2;\r\n\r\n      this.drawPieSlice(\r\n        ctx,\r\n        widthCanvas,\r\n        heightCanvas,\r\n        Math.min(widthCanvas, heightCanvas),\r\n        start_angle,\r\n        start_angle + slice_angle,\r\n        this.colors[color_index % this.colors.length]\r\n      );\r\n\r\n      start_angle += slice_angle;\r\n      color_index++;\r\n    }\r\n\r\n    //to create the doughnut chart\r\n    this.drawPieSlice(\r\n      ctx,\r\n      canvasEl.width / 2,\r\n      canvasEl.height / 2,\r\n      this.doughnutHoleSize * Math.min(canvasEl.width / 2, canvasEl.height / 2),\r\n      0,\r\n      2 * Math.PI,\r\n      '#fff'\r\n    );\r\n\r\n    for (categ in this.data) {\r\n      val = this.data[categ];\r\n      slice_angle = (2 * Math.PI * val) / total_value;\r\n      let pieRadius = Math.min(canvasEl.width / 2, canvasEl.height / 2);\r\n\r\n      //to create the doughnut chart\r\n      let offset = (pieRadius * this.doughnutHoleSize) / 2;\r\n      let offsetPieRadius = offset + pieRadius / 2;\r\n      let labelX = canvasEl.width / 2 + (offsetPieRadius) * Math.cos(start_angle + slice_angle / 2);\r\n      let labelY = canvasEl.height / 2 + (offsetPieRadius) * Math.sin(start_angle + slice_angle / 2);\r\n\r\n      let labelText = Math.round((100 * val) / total_value);\r\n      if (labelText > 0) {\r\n        ctx.fillStyle = 'white';\r\n        ctx.font = 'bold 1em Arial';\r\n        ctx.fillText(labelText + '%', labelX, labelY);\r\n      }\r\n      start_angle += slice_angle;\r\n    }\r\n\r\n    if (this.legend) {\r\n      color_index = 0;\r\n      let legendHTML = '';\r\n      for (categ in this.data) {\r\n        legendHTML +=\r\n          \"<div><span style='display:inline-block;width:20px;background-color:\" +\r\n          this.colors[color_index++] +\r\n          \";'>&nbsp;</span> \" +\r\n          categ +\r\n          '</div>';\r\n      }\r\n      this.legend.nativeElement.innerHTML = legendHTML;\r\n    }\r\n  }\r\n}\r\n","import { Component, AfterViewInit, ElementRef, ViewChild, Input } from '@angular/core';\r\nimport { UtilChart } from './util.chart';\r\n\r\n@Component({\r\n  selector: 'canvas-chart-pie',\r\n  template: `\r\n           <div style='display: flex;flex-wrap: nowrap;'>\r\n                <canvas #canvas></canvas>\r\n                <div #legend></div>\r\n           <div>\r\n    `\r\n})\r\nexport class ChartPieComponent extends UtilChart implements AfterViewInit {\r\n  @ViewChild('canvas')\r\n  public canvas: ElementRef;\r\n  @ViewChild('legend')\r\n  public legend: ElementRef;\r\n\r\n  @Input()\r\n  data: any = {};\r\n  @Input()\r\n  colors: string[] = [];\r\n\r\n  ngAfterViewInit(): void {\r\n    let canvasEl: HTMLCanvasElement = this.canvas.nativeElement;\r\n    let ctx = canvasEl.getContext('2d');\r\n\r\n    let total_value = 0;\r\n    let color_index = 0;\r\n    for (var categ in this.data) {\r\n      var val = this.data[categ];\r\n      total_value += val;\r\n    }\r\n\r\n    let start_angle = 0;\r\n    for (categ in this.data) {\r\n      val = this.data[categ];\r\n      var slice_angle = (2 * Math.PI * val) / total_value;\r\n\r\n      this.drawPieSlice(\r\n        ctx,\r\n        canvasEl.width / 2,\r\n        canvasEl.height / 2,\r\n        Math.min(canvasEl.width / 2, canvasEl.height / 2),\r\n        start_angle,\r\n        start_angle + slice_angle,\r\n        this.colors[color_index % this.colors.length]\r\n      );\r\n\r\n      start_angle += slice_angle;\r\n      color_index++;\r\n    }\r\n\r\n    for (categ in this.data) {\r\n      val = this.data[categ];\r\n      slice_angle = (2 * Math.PI * val) / total_value;\r\n      let pieRadius = Math.min(canvasEl.width / 2, canvasEl.height / 2);\r\n      let labelX = canvasEl.width / 2 + (pieRadius / 2) * Math.cos(start_angle + slice_angle / 2);\r\n      let labelY = canvasEl.height / 2 + (pieRadius / 2) * Math.sin(start_angle + slice_angle / 2);\r\n\r\n      let labelText = Math.round((100 * val) / total_value);\r\n      if (labelText > 0) {\r\n        ctx.fillStyle = 'white';\r\n        ctx.font = 'bold 1em Arial';\r\n        ctx.fillText(labelText + '%', labelX, labelY);\r\n      }\r\n      start_angle += slice_angle;\r\n    }\r\n\r\n    if (this.legend) {\r\n      color_index = 0;\r\n      let legendHTML = '';\r\n      for (categ in this.data) {\r\n        legendHTML +=\r\n          \"<div><span style='display:inline-block;width:20px;background-color:\" +\r\n          this.colors[color_index++] +\r\n          \";'>&nbsp;</span> \" +\r\n          categ +\r\n          '</div>';\r\n      }\r\n      this.legend.nativeElement.innerHTML = legendHTML;\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { ChartDunotComponent } from './chart-dunot.component';\r\nimport { ChartPieComponent } from './chart-pie.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  exports: [ChartDunotComponent, ChartPieComponent],\r\n  declarations: [ChartDunotComponent, ChartPieComponent]\r\n})\r\nexport class ChartModule {}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {ChartDunotComponent as ɵa} from './src/app/modules/chart/chart-dunot.component';\nexport {ChartPieComponent as ɵc} from './src/app/modules/chart/chart-pie.component';\nexport {UtilChart as ɵb} from './src/app/modules/chart/util.chart';"],"names":[],"mappings":"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"}